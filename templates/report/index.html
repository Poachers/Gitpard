{% extends "main.html" %}
{% load staticfiles %}

{% block content %}
    <div ng-controller="ReportIndexCtrl">
        <div class="row">
            <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
                <a href="/report/new/#{$ getRepoId() $}" class="btn btn-primary btn-block">
                    Создать новый отчет</a>
            </div>
        </div>
        <hr/>
        <div class="repo-list">
            <div class="row report-head">
                <div class="col-md-2">Тип отчет</div>
                <div class="col-md-2">Дата подготовки</div>
                <div class="col-md-2">Ветка</div>
                <div class="col-md-2">Статус</div>
                <div class="col-md-4">Действие</div>
            </div>
            <div class="row titles" ng-repeat="report in reports">
                <div class="col-md-2">
                    <span ng-if="report.kind == 1">По разработчику</span>
                    <span ng-if="report.kind == 2">По файлу</span>
                </div>
                <div class="col-md-2" title="{$ report.datetime | date:'HH:MM:ss' $}">
                    {$ report.datetime | date:'dd.MM.yyyy' $}
                </div>
                <div class="col-md-2">{$ report.branch $}</div>
                <div class="col-md-2">
                    <span class="text-danger" ng-if="report.state == -1">Не удалось</span>
                    <span class="text-warning" ng-if="report.state == 0">Подготовка</span>
                    <span class="text-success" ng-if="report.state == 1">Готово</span>
                </div>
                <div class="col-md-4">
                    <div class="btn-group btn-group-sm">
                        <div class="btn btn-primary btn-sm" ng-click="reportView(report)"
                             ng-disabled="[1].indexOf(report.state) == -1">
                            Посмотреть
                        </div>
                        <!--div class="btn btn-success btn-sm" ng-click="reportDownload(report)"
                             ng-disabled="[2].indexOf(report.state) == -1">
                            Скачать
                        </div-->
                        <div class="btn btn-danger btn-sm" ng-click="reportDelete(report)"
                             ng-disabled="[-1, 1].indexOf(report.state) == -1">
                            Удалить
                        </div>
                    </div>
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
    </div>
{% endblock %}

{% block scripts %}
    <script src="{% static 'js/report/index/main.js' %}"></script>
{% endblock scripts %}